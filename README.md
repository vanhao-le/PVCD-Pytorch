# PVCD-Pytorch
This repo includes the implementations of the Neural Networks for partial video copy detection. 

# Extract frames

The frames of all videos are extracted by using FFmpeg library. Thus, a video contains 'num_frames' / 'total_frames'.

# Create dataset

The protocol to generate the input for CNN

A video -> total_frames -> num_segments -> d_frames -> k * d_frames, where d_frames means the frame pairs such as 2-frames, 3-frames.
K stands for the number of subsamples of d_frames.

For example: a VideoRecord = [image_list_path, total_frames, classIDx] e.g., [v_CricketShot_g08_c01, 75, 0]
The 'v_CricketShot_g08_c01' has a total of 75 frames. After that, we select 'num_segments' = 30 for generating the number of segments.
From 30 frames, we then generate a combination of d-frames (e.g., 2_frames, 3_frames) like (0, 1), (0, 2) (0,3) ...
The total number of the combination of 2_frames is 30! / 2! / (30-2)!). However, we only select k subsamples over the overall combinations for
efficient training. These steps are repeated for the other d_frames.

The input of the CNN is formated [5, 8, 3, 224, 224] where batch_size = 5, num_segments = 8, num_channels = 3, width = height = 224.
The k * d_frames is then generated by TRN Module.




### Update git after ignoring redundant files

git rm -rf --cached .

git add .

git commit -m ".gitignore is now working"









